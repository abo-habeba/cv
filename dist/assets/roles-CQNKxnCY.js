import{$ as T,J as A,G as B,r as c,q as R,X as g,_ as v,c as w,L as i,V as f,P as u,v as n,M as V,U as S,N as E,F as y,O as F,a0 as L,a1 as $,Q as M}from"./index-CHSsISAk.js";import{V as O,a as q}from"./VTextField-CMKdPTNq.js";import{V as b,a as z}from"./VCard-BL9DEfJB.js";import{V as G}from"./VSelect-BX3frkbO.js";import{t as Q}from"./VBtn--KRQPwnb.js";import{V as h}from"./VCheckbox-D_Jc_2o-.js";import"./VIcon-Cq3ABlBs.js";import"./VInput-BZcQNRFC.js";import"./VList-DzWxr-pL.js";import"./VOverlay-BkT7euYh.js";import"./VMenu-DO1D66E9.js";import"./VCheckboxBtn-D9UKCKFZ.js";import"./VSelectionControl-BKER4lii.js";import"./VChip-B8T8vs9v.js";const X=d=>(L("data-v-af30b07b"),d=d(),$(),d),j=X(()=>M("h1",{class:"ma-5"},"roles",-1)),D={key:0,class:"px-10 py-0 my-0 d-flex flex-wrap"},H={__name:"roles",setup(d){const t=A(),x=B(),l=c([]),a=c([]),p=c([]);t.fetchUser().then(()=>{l.value=t.user.role,a.value=t.user}),R(()=>{t.loadengApi=!0,g.get("users").then(e=>{p.value=e.data.data,t.loadengApi=!1}).catch(()=>{_("هناك خطا ما حاول مره اخري")})});function C(e){a.value=p.value.find(s=>s.id===e),l.value=a.value.role}const I=e=>{v.success(e,{theme:"colored",position:v.POSITION.TOP_LEFT})},_=e=>{v.error(e,{theme:"colored",position:v.POSITION.TOP_LEFT})};function k(){t.loadengApi=!0,a.value.role=JSON.stringify(l.value),a.value.address=JSON.stringify(a.value.address),a.value.bio=JSON.stringify(a.value.bio),a.value.first_name=JSON.stringify(a.value.first_name),a.value.last_name=JSON.stringify(a.value.last_name),a.value.position=JSON.stringify(a.value.position),g.put(`users/${a.value.id}`,a.value).then(e=>{t.user.id==a.value.id&&localStorage.setItem("user",JSON.stringify(e.data.data)),t.loadengApi=!1,I("تم تعيين الصلاحيات بنجاح")}).catch(e=>{t.loadengApi=!1,_("هناك خطا ما حاول مره اخري")})}const J=w(()=>x.getRoutes().filter(e=>e.meta.roles)),m=c({});function N(e){l.value.includes(e)?m.value[e]&&(l.value=l.value.concat(m.value[e]),delete m.value[e]):(m.value[e]=l.value.filter(s=>s.includes(e)),l.value=l.value.filter(s=>!s.includes(e)))}return(e,s)=>(i(),f(z,{dir:"rtl",class:""},{default:u(()=>[j,n(q,null,{default:u(()=>[n(O,{cols:"12"},{default:u(()=>[n(b,{class:"pt-5 px-5"},{default:u(()=>[n(G,{label:"اختر مستخدم",variant:"outlined",items:p.value,"item-title":"username","item-value":"id",modelValue:a.value,"onUpdate:modelValue":[s[0]||(s[0]=o=>a.value=o),s[1]||(s[1]=o=>C(a.value))]},null,8,["items","modelValue"])]),_:1})]),_:1}),(i(!0),V(y,null,S(E(J),(o,U)=>(i(),f(O,{cols:"12",md:"6",key:U},{default:u(()=>[n(b,{class:""},{prepend:u(()=>[n(h,{onChange:r=>N(o.name),value:o.name,modelValue:l.value,"onUpdate:modelValue":s[2]||(s[2]=r=>l.value=r),label:o.name},null,8,["onChange","value","modelValue","label"])]),default:u(()=>[l.value.includes(o.name)?(i(),V("div",D,[(i(!0),V(y,null,S(o.meta.roles,r=>(i(),f(h,{key:r,value:o.name+"."+r,modelValue:l.value,"onUpdate:modelValue":s[3]||(s[3]=P=>l.value=P),label:r},null,8,["value","modelValue","label"]))),128))])):F("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),n(Q,{class:"ma-5",onClick:k,icon:"mdi-content-save-outline",color:"success",size:"small"})]),_:1}))}},de=T(H,[["__scopeId","data-v-af30b07b"]]);export{de as default};
