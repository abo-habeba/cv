import{_ as O}from"./imageInput-Dr5xBnDm.js";import{s as z,n as D,f as E,d as J}from"./apiService-RRzB5j9M.js";import{F as N,r as m,H as k,I as b,v as l,L as n,O as S,M as t,P as u,q as T,S as F,R as A,Q as L}from"./index-CtRZQFqT.js";import{w as x}from"./forwardRefs-D8dSKpRK.js";import{a as c,V as M}from"./VRow-bXb482RW.js";import{V as $}from"./VGrid-B3UskQhC.js";import{V as j}from"./VForm-2veVjxGp.js";import{V as v}from"./VTextField-C9owvDKT.js";import{V as R}from"./VDialog-2taMZUNp.js";import{_ as q}from"./ShowImages-ZvCDhNtN.js";import{V as H}from"./VTable-BvoCu59u.js";import{V as P}from"./VContainer-DHcTt46A.js";import"./VLabel-KC-eJlG_.js";import"./index-B5qp4doV.js";import"./VChip-BObr_FSf.js";import"./VOverlay-6884-3dz.js";const Q={class:"ma-5"},G={__name:"CredentialForm",emits:["runItems"],setup(B,{expose:I,emit:C}){const g=N(),y=C,_=m(!1),s=m({}),r=m({}),o=m({}),p=m({});function h(){r.value={ar:"",en:""},o.value={ar:"",en:""},p.value={ar:"",en:""},s.value={credential_id:"",issue_date:"",expiry_date:!1,id:null},_.value=!1,y("runItems")}function U(i){const e=new FormData;e.append("name",JSON.stringify(r.value)),e.append("issuer",JSON.stringify(o.value)),e.append("description",JSON.stringify(p.value)),e.append("credential_id",s.value.credential_id),e.append("issue_date",s.value.issue_date),e.append("expiry_date",s.value.expiry_date||""),e.append("user_id",g.user.id),i.length&&i.forEach(V=>{e.append("photos[]",V,V.name)}),s.value.id&&e.append("_method","put"),z("credentials",e,s.value.id).then(V=>{s.value=V.data,y("runItems"),h()})}const d=m(null),f=()=>{if(!r.value.ar&&!r.value.en){D("حقل الاسم مطلوب عربي او انجليزي");return}if(!o.value.ar&&!o.value.en){D("حقل اسم المنظمة مطلوب عربي او انجليزي");return}if(!s.value.issue_date){D("حقل تاريخ الاصدار مطلوب ");return}d.value&&d.value.compressImages()},w=(i={})=>{Object.keys(i).length!==0&&(r.value=i.name,o.value=i.issuer,p.value=i.description),_.value=!0,s.value=i};return I({addNew:w}),(i,e)=>{const V=O;return k(),b("div",null,[l(c,{cols:"auto"},{default:n(()=>[l(x,{onClick:e[0]||(e[0]=a=>w()),icon:"mdi-plus",color:"success",size:"small",to:""})]),_:1}),l(R,{class:"text-center",modelValue:_.value,"onUpdate:modelValue":e[10]||(e[10]=a=>_.value=a),"max-width":"900",persistent:""},{default:n(()=>[l($,{class:"pa-5"},{actions:n(()=>[l(x,{onClick:h},{default:n(()=>[S(" اغلاق ")]),_:1}),l(x,{onClick:f},{default:n(()=>[S(" موافق ")]),_:1})]),default:n(()=>[t("h2",Q,u(s.value.id?"تعديل ":" اضافة "),1),l(j,null,{default:n(()=>[l(M,null,{default:n(()=>[l(c,{cols:"12",md:"6"},{default:n(()=>[l(v,{modelValue:r.value.ar,"onUpdate:modelValue":e[1]||(e[1]=a=>r.value.ar=a),label:" الاسم "},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",md:"6"},{default:n(()=>[l(v,{modelValue:r.value.en,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value.en=a),label:"Name"},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",md:"6"},{default:n(()=>[l(v,{modelValue:o.value.ar,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.ar=a),label:" اسم المنظمة "},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",md:"6"},{default:n(()=>[l(v,{modelValue:o.value.en,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.en=a),label:"Issuer"},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",md:"6"},{default:n(()=>[l(v,{modelValue:p.value.ar,"onUpdate:modelValue":e[5]||(e[5]=a=>p.value.ar=a),label:" الوصف "},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",md:"6"},{default:n(()=>[l(v,{modelValue:p.value.en,"onUpdate:modelValue":e[6]||(e[6]=a=>p.value.en=a),label:"Description"},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",md:"6"},{default:n(()=>[l(v,{modelValue:s.value.credential_id,"onUpdate:modelValue":e[7]||(e[7]=a=>s.value.credential_id=a),label:"الرقم التعريفي"},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",md:"6"},{default:n(()=>[l(v,{type:"date",modelValue:s.value.issue_date,"onUpdate:modelValue":e[8]||(e[8]=a=>s.value.issue_date=a),label:"تاريخ الإصدار  "},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",md:"6"},{default:n(()=>[l(v,{type:"date",modelValue:s.value.expiry_date,"onUpdate:modelValue":e[9]||(e[9]=a=>s.value.expiry_date=a),label:"تاريخ الانتهاء"},null,8,["modelValue"])]),_:1}),l(V,{ref_key:"imageInputRef",ref:d,onSaveCompressedImages:U},null,512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},K=t("h2",{class:"ma-5"},"هل تريد حذف العنصر بالفعل",-1),W=t("thead",null,[t("tr",null,[t("th",{class:"text-center"},"#"),t("th",{class:"text-center"},"الاسم"),t("th",{class:"text-center"},"name"),t("th",{class:"text-center"},"اسم المنظمة"),t("th",{class:"text-center"},"issuer"),t("th",{class:"text-center"},"الوصف"),t("th",{class:"text-center"},"Description"),t("th",{class:"text-center"},"تاريخ الإصدار"),t("th",{class:"text-center"},"تاريخ انتهاء"),t("th",{class:"text-center"},"الرقم التعريفي للشهادة"),t("th",{class:"text-center"},"صورة"),t("th",{class:"text-center"},"تاريخ الإنشاء"),t("th",{class:"text-center sticky-column"},". . .")])],-1),X={class:"sticky-column"},Y={key:1,class:"text-alert"},ve={__name:"index",setup(B){const I=N(),C=m(null),g=m(!1),y=m([]),_=m(""),s=m(null),r=d=>{s.value.opaenDialog(d)};T(()=>{o()});function o(){I.loadengApi=!0,E("credentials").then(d=>{y.value=d.data,_.value=""})}function p(d){g.value=!0,_.value=d}function h(){I.loadengApi=!0,J("credentials/delete",{id:[_.value.id]}).then(()=>{o(),g.value=!1})}const U=d=>{var f;(f=C.value)==null||f.addNew(d)};return(d,f)=>{const w=q,i=G;return k(),F(P,null,{default:n(()=>[l(R,{class:"text-center",modelValue:g.value,"onUpdate:modelValue":f[1]||(f[1]=e=>g.value=e),"max-width":"400",persistent:""},{default:n(()=>[l($,{class:"pa-5"},{default:n(()=>[K,l(x,{class:"ma-1",onClick:h},{default:n(()=>[S(" موافق ")]),_:1}),l(x,{class:"ma-1",onClick:f[0]||(f[0]=e=>g.value=!1)},{default:n(()=>[S(" اغلاق ")]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(w,{ref_key:"isShowImage",ref:s,onRunItems:o},null,512),l(i,{ref_key:"itemForm",ref:C,onRunItems:o},null,512),y.value.length>0?(k(),F(H,{key:0,style:{"white-space":"nowrap"},dir:"rtl",class:"h"},{default:n(()=>[W,t("tbody",null,[(k(!0),b(L,null,A(y.value,(e,V)=>(k(),b("tr",{key:e.id},[t("td",null,u(V+1),1),t("td",null,u(e.name.ar),1),t("td",null,u(e.name.en),1),t("td",null,u(e.issuer.ar),1),t("td",null,u(e.issuer.en),1),t("td",null,u(e.description.ar),1),t("td",null,u(e.description.en),1),t("td",null,u(e.issue_date),1),t("td",null,u(e.expiry_date),1),t("td",null,u(e.credential_id),1),t("td",null,u(e.image),1),t("td",null,u(e.created_at),1),t("td",X,[l(x,{onClick:a=>r(e.photos),icon:"mdi-image-edit-outline",color:"info",size:"small"},null,8,["onClick"]),l(x,{onClick:a=>p(e),class:"mx-3",icon:"mdi-delete",color:"red",size:"small"},null,8,["onClick"]),l(x,{onClick:a=>U(e),icon:"mdi-pencil",color:"info",size:"small"},null,8,["onClick"])])]))),128))])]),_:1})):(k(),b("p",Y,"لا توجد اي بيانات"))]),_:1})}}};export{ve as default};
